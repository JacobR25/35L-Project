<!DOCTYPE html>
    <html lang="en">
      <head>
        <meta charset="UTF-8" />
        <title>Budget Calculator</title>
        <script src="https://cdn.jsdelivr.net/npm/react@17.0.2/umd/react.production.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/react-dom@17.0.2/umd/react-dom.production.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/react-chartjs-2@3.0.4/dist/react-chartjs-2.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>

      </head>
      <body>
        <form onsubmit="myFunction(event)">
          <label for="monthlyIncome">Monthly Income: </label>
          <input type="text" id="monthlyIncome" name="monthlyIncome" /> <br /><br />
          <label for="rent">Rent: </label>
          <input type="text" id="rent" name="rent" /> <br /><br />
          <label for="transportation">Transportation: </label>
          <input type="text" id="transportation" name="transportation" /> <br /><br />
          <label for="food">Food: </label>
          <input type="text" id="food" name="food" /><br /><br />
          <label for="utilities">Utilities: </label>
          <input type="text" id="utilities" name="utilities" /><br /><br />
          <label for="insurance">Insurance: </label>
          <input type="text" id="insurance" name="insurance" /><br /><br />
          <label for="savings">Savings: </label>
          <input type="text" id="savings" name="savings" /><br /><br />
          <label for="entertainment">Entertainment: </label>
          <input type="text" id="entertainment" name="entertainment" /><br /><br />
          <label for="other">Other: </label>
          <input type="text" id="other" name="other" /><br /><br />
          <input type="submit" value="Submit" /><br /><br />
          <div id="chart"></div>
        </form>
        <script>
          var rent = 0;
          function myFunction(event) {
            event.preventDefault();
            console.log("in myFunction");
            var monthlyIncome = parseFloat(document.getElementById("monthlyIncome").value);
            var rentPercent = parseFloat(document.getElementById("rent").value);
            var transportationPercent = parseFloat(document.getElementById("transportation").value);
            var foodPercent = parseFloat(document.getElementById("food").value);
            var utilitiesPercent = parseFloat(document.getElementById("utilities").value);
            var insurancePercent = parseFloat(document.getElementById("insurance").value);
            var savingsPercent = parseFloat(document.getElementById("savings").value);
            var entertainmentPercent = parseFloat(document.getElementById("entertainment").value);
            //just doing budget to map, make it fully customizable
            //here we will get the percentages that they want
            var rentPercent = document.getElementById("rent").value; //will actually get from input box
            var transportationPercent = document.getElementById("transportation").value; //will actually get from input box
            var foodPercent = document.getElementById("food").value;
            var utilitiesPercent = document.getElementById("utilities").value;
            var insurancePercent = document.getElementById("insurance").value;
            var savingsPercent = document.getElementById("savings").value;
            var entertainmentPercent = document.getElementById("entertainment").value;
            var otherPercent = document.getElementById("other").value;
            rent = rentPercent*monthlyIncome;
            var data = [          {title: "Rent", value: (monthlyIncome * rentPercent *.01), color: '#F2C4DE'},          {title: "Transportation", value: (monthlyIncome * transportationPercent*.01), color: '#71B1D9'},          {title: "Food", value: (monthlyIncome * foodPercent*.01), color: '#AED8F2'},          {title: "Utilities", value: (monthlyIncome * utilitiesPercent*.01), color: '#F2CDC4'},          {title: "Insurance", value: (monthlyIncome * insurancePercent*.01), color: '#A9B5D9'},          {title: "Savings", value: (monthlyIncome * savingsPercent*.01), color: '#F2A477'},          {title: "Entertainment", value: (monthlyIncome * entertainmentPercent*.01),color: '#5F9595'},          {title: "Other", value: (monthlyIncome * otherPercent*.01), color: '#D9BCF2'},        ];
            // check if canvas already exists, and remove if it does
            var existingCanvas = document.getElementById('myChart');
            if (existingCanvas) {
                existingCanvas.remove();
            }
            // create the chart
            var canvas = document.createElement('canvas');
            canvas.id = 'myChart';
            canvas.width = 400;
            canvas.height = 400;
            document.body.appendChild(canvas);
            var ctx = canvas.getContext('2d');
            var chart = new Chart(ctx, {
            type: 'pie',
            data: {
                labels: data.map(item => item.title),
                datasets: [{
                data: data.map(item => item.value),
                backgroundColor: data.map(item => item.color)
                }]
            },
            options: {
                responsive: false,
                maintainAspectRatio: false,
            }
            });
        }
        function findCountyNames(rent) {
          document.write("Hello");
          const rentLowerBound = rent * 0.9;
          const rentUpperBound = rent * 1.1;
          const countyNames = [];
          document.write("Check1");
      }
        var button = document.createElement("button");
        button.innerHTML = "Show Counties in Budget";
        button.onclick = printAVGColumn;
        document.body.appendChild(button);
      
        function printAVGColumn() {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', './counties - Sheet1.csv');
          xhr.onload = function() {
              const csvData = xhr.response;
              const rows = csvData.split('\n');
              const columnData = [];
              for (let i = 0; i < rows.length; i++) {
                const values = rows[i].split(',');
                const average = values[6];
                document.write(average);
                columnData.push(average);
              }
      
      const outputElement = document.getElementById('output');
      outputElement.innerHTML = columnData.join('<br>');
      document.write(columnData);
      }

      xhr.send();
    }
  </script>
  </div>
</body>
</html> 
    